<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Morosos</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Confetti CDN -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body class="bg-gradient-to-br from-fuchsia-600 via-pink-500 to-amber-400 text-white min-h-screen flex flex-col items-center p-4">

  <header class="text-center mb-6">
    <h1 class="text-4xl font-extrabold flex items-center justify-center gap-3">
      ðŸŽ‰ Murenses morosos
    </h1>
    <p class="mt-2 text-white/90">Haz click en tu nombre y mira lo que debes ðŸ˜‰</p>
  </header>

  <!-- Botones circulares -->
  <section class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mb-8" id="buttons-container">
    <!-- Botones generados por JS -->
  </section>

  <!-- BotÃ³n para mostrar resumen -->
  <button id="summary-btn" class="mb-6 px-4 py-2 rounded-full bg-white text-fuchsia-700 font-bold shadow-lg hover:scale-105 transition-transform">
    Ver resumen de morosos
  </button>

  <!-- Contenedor grÃ¡fico -->
  <div class="w-full max-w-5xl bg-white/20 p-4 rounded-xl mb-8 hidden" id="chart-container">
    <canvas id="barChart"></canvas>
  </div>

  <!-- Modal -->
  <div id="modal" class="fixed inset-0 bg-black/60 flex items-center justify-center hidden z-50">
    <div class="bg-white/90 text-fuchsia-900 rounded-2xl p-6 max-w-sm w-full relative">
      <button id="modal-close" class="absolute top-2 right-3 font-bold text-xl">&times;</button>
      <h2 class="text-xl font-bold mb-2" id="modal-name"></h2>
      <p class="font-bold text-fuchsia-700 mb-4" id="modal-total"></p>
      <ul id="modal-items" class="space-y-1"></ul>
    </div>
  </div>

<script>
// ===== Datos hardcodeados =====
const people = [
  { name: "Jose", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Entrecot", price: 11.53333333 }]},
  { name: "FerF", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Entrecot", price: 11.53333333 }, { name: "HeladosSidra", price: 7 }, { name: "CafÃ©", price: 1.285714286 }, { name: "Cerveza", price: 5.4 }]},
  { name: "Fersoto", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Entrecot", price: 11.53333333 }, { name: "HeladosSidra", price: 7 }, { name: "CafÃ©", price: 2.7 }]},
  { name: "Juli", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Entrecot", price: 11.53333333 }, { name: "Postres", price: 2.888888889 }, { name: "Cerveza", price: 5.4 }]},
  { name: "Estevez", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Postres", price: 2.888888889 }, { name: "CafÃ©", price: 1.285714286 }]},
  { name: "Sergio", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Entrecot", price: 11.53333333 }, { name: "Postres", price: 2.888888889 }, { name: "CafÃ©", price: 1.285714286 }]},
  { name: "Carlos", items: [{ name: "PanAgua", price: 1.608333333 }, { name: "Parrillada", price: 22.7 }, { name: "Postres", price: 2.888888889 }, { name: "CafÃ©Baileys", price: 2.96 }]},
  { name: "Manu", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Entrecot", price: 11.53333333 }, { name: "Postres", price: 2.888888889 }, { name: "CafÃ©", price: 1.285714286 }]},
  { name: "Davo", items: [{ name: "PanAgua", price: 4.208333333 }, { name: "Parrillada", price: 22.7 }, { name: "Postres", price: 2.888888889 }, { name: "CafÃ©Baileys", price: 2.96 }]},
  { name: "Pablo", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Postres", price: 2.888888889 }, { name: "CafÃ©", price: 1.285714286 }]},
  { name: "Maria Junque", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Postres", price: 2.888888889 }, { name: "CafÃ©", price: 1.285714286 }]},
  { name: "Aida", items: [{ name: "PanAgua", price: 2.908333333 }, { name: "Parrillada", price: 22.7 }, { name: "Postres", price: 2.888888889 }, { name: "CafÃ©", price: 1.285714286 }]},
  { name: "Imanol", items: [{ name: "Menu", price: 27 }]},
  { name: "Nerea", items: [{ name: "Menu", price: 27 }]},
  { name: "Alba", items: [{ name: "Menu", price: 27 }]},
  { name: "MarÃ­a Madrid", items: [{ name: "Menu", price: 27 }]},
  { name: "Elsa", items: [{ name: "Menu", price: 27 }]}
];

// Calculamos totales
people.forEach(p => p.total = p.items.reduce((a,b)=>a+b.price,0));

// ===== Generar botones =====
const container = document.getElementById("buttons-container");
people.forEach(p => {
  const btn = document.createElement("button");
  btn.textContent = p.name;
  btn.className = "aspect-square rounded-full bg-white text-fuchsia-700 font-extrabold text-lg flex items-center justify-center shadow-xl border-4 border-white/60 hover:shadow-2xl hover:scale-105 transition-transform";
  btn.onclick = () => openModal(p);
  container.appendChild(btn);
});

// ===== Modal =====
const modal = document.getElementById("modal");
const modalName = document.getElementById("modal-name");
const modalTotal = document.getElementById("modal-total");
const modalItems = document.getElementById("modal-items");
document.getElementById("modal-close").onclick = ()=> modal.classList.add("hidden");

function openModal(person){
  modalName.textContent = person.name;
  modalTotal.textContent = `Â¡Debes ${person.total.toFixed(2)}â‚¬! ðŸŽ‰`;
  modalItems.innerHTML = "";
  person.items.forEach(it=>{
    const li = document.createElement("li");
    li.textContent = `${it.name}: ${it.price.toFixed(2)}â‚¬`;
    modalItems.appendChild(li);
  });
  modal.classList.remove("hidden");
  // Confetti
  confetti({
    particleCount: 120,
    spread: 100,
    origin: { y: 0.6 }
  });
}

// ===== GrÃ¡fico de barras =====
const summaryBtn = document.getElementById("summary-btn");
const chartContainer = document.getElementById("chart-container");
let chartInitialized = false;
summaryBtn.onclick = ()=>{
  chartContainer.classList.toggle("hidden");
  if(!chartInitialized){
    const ctx = document.getElementById('barChart').getContext('2d');
    // Generar colores automÃ¡ticos
    const colors = people.map((_, i) => `hsl(${i * 360 / people.length}, 70%, 60%)`);
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: people.map(p=>p.name),
        datasets: [{
          label: 'Total â‚¬',
          data: people.map(p=>p.total),
          backgroundColor: colors
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false }
        },
        scales: {
          y: { beginAtZero: true }
        }
      }
    });
    chartInitialized = true;
  }
};
</script>

</body>
</html>
